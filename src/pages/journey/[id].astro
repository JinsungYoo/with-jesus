---
export const prerender = false;

import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import FormattedDate from '../../components/FormattedDate.astro';

const { id } = Astro.params;
const { session, post, error } = Astro.props;
---

<!DOCTYPE html>
<html lang="ko">
  <head>
    <BaseHead title={post?.title ?? "ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤"} description={post?.content?.slice(0, 100) ?? "ì´ í˜ì´ì§€ë¥¼ ë³´ë ¤ë©´ ë¡œê·¸ì¸í•´ì•¼ í•©ë‹ˆë‹¤."} />
    <style>
      .notice {
        margin: 4rem auto;
        padding: 2rem;
        text-align: center;
        background: #fff3cd;
        color: #856404;
        border: 1px solid #ffeeba;
        border-radius: 8px;
        max-width: 500px;
        font-size: 1.1rem;
      }
    </style>
  </head>
  <body>
    <Header />
    <main style="max-width: 800px; margin: 2rem auto; padding: 1rem;">
      {
        !session ? (
          <div class="notice">ğŸ”’ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™ ì¤‘...<br />You need to be logged in. Taking you to the login page...</div>
        ) : error || !post ? (
          <div class="notice">âŒ ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>
        ) : (
          <>
            <h1>{post.title}</h1>
            <p style="color: #555; font-size: 0.9rem;">
              by {post.profiles?.name ?? 'ìµëª…'} â€¢ <FormattedDate date={post.created_at} />
            </p>
            <img src={post.image_url || '/default.jpg'} alt="ì¸ë„¤ì¼" style="max-width: 100%; margin-top: 1rem; border-radius: 8px;" />
            <div style="margin-top: 2rem; line-height: 1.6;">
              {post.content}
            </div>
          </>
        )
      }
    </main>
    <Footer />
  </body>
</html>
